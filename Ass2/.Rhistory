boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
# Ass 2, Advanced Data Analysis
# Part 3
library(ordinal)
library(rcompanion)
library(car)
### LOAD DATA
fan.data <- read.table(file ='C:/Users/matth/Documents/GitHub/Adv-data-analysis-projects/Ass2/CeilingFan.csv', sep = ";")
fan.data$fanSpeed.f <- factor(fan.data$fanSpeed)
fan.data$fanType.f <- factor(fan.data$fanType)
fan.data$TSV <- factor(fan.data$TSV)
# TEST FOR INDEPENDENCE
coTable = table(fan.data$TSV,fan.data$fanSpeed) #contingency
chisq.test(table(fan.data$TSV,fan.data$fanSpeed)) #low p-value -> independent
fisher.test(fan.data$TSV,fan.data$fanSpeed)
cramerV(coTable,bias.correct =TRUE)
0.# MAKE MODELS WITH ORDINAL PACKAGE
# ordinal variables (ranked data, distance between values not known)
model0.clm <- clm( TSV ~ fanSpeed, data = fan.data )
summary(model0.clm) #
model0f.clm <- clm( TSV ~ fanSpeed.f, data = fan.data )
summary(model0f.clm)
#Anova(model0.clm,type = 'II')
anova(model0f.clm)
anova(model0.clm)
anova(model0f.clm,model0.clm) #independence not assumed
par(mfrow=c(2,2))
plot(model0.clm)
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
model1f.clm
anova(model1f.clm)
anova(model1f.clm,model0f.clm) # new model is better, both AIC and LogLik wise
x=predict(model0.clm,data=1:20)
plot(predict(model1f.clm)$fit)
plot(fan.data$TSV)
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
# Ass 2, Advanced Data Analysis
# Part 3
library(ordinal)
library(rcompanion)
library(car)
### LOAD DATA
fan.data <- read.table(file ='C:/Users/matth/Documents/GitHub/Adv-data-analysis-projects/Ass2/CeilingFan.csv', sep = ";")
fan.data$fanSpeed.f <- factor(fan.data$fanSpeed)
fan.data$fanType.f <- factor(fan.data$fanType)
fan.data$TSV <- factor(fan.data$TSV)
# TEST FOR INDEPENDENCE
coTable = table(fan.data$TSV,fan.data$fanSpeed) #contingency
chisq.test(table(fan.data$TSV,fan.data$fanSpeed)) #low p-value -> independent
fisher.test(fan.data$TSV,fan.data$fanSpeed)
cramerV(coTable,bias.correct =TRUE)
0.# MAKE MODELS WITH ORDINAL PACKAGE
# ordinal variables (ranked data, distance between values not known)
model0.clm <- clm( TSV ~ fanSpeed, data = fan.data )
summary(model0.clm) #
model0f.clm <- clm( TSV ~ fanSpeed.f, data = fan.data )
summary(model0f.clm)
#Anova(model0.clm,type = 'II')
anova(model0f.clm)
anova(model0.clm)
anova(model0f.clm,model0.clm) #independence not assumed
par(mfrow=c(2,2))
plot(model0.clm)
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
model1f.clm
anova(model1f.clm)
anova(model1f.clm,model0f.clm) # new model is better, both AIC and LogLik wise
x=predict(model0.clm,data=1:20)
plot(predict(model1f.clm)$fit)
plot(fan.data$TSV)
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
library(ordinal)
library(rcompanion)
library(car)
### LOAD DATA
fan.data <- read.table(file ='C:/Users/matth/Documents/GitHub/Adv-data-analysis-projects/Ass2/CeilingFan.csv', sep = ";")
fan.data$fanSpeed.f <- factor(fan.data$fanSpeed)
fan.data$fanType.f <- factor(fan.data$fanType)
fan.data$TSV <- factor(fan.data$TSV)
# TEST FOR INDEPENDENCE
coTable = table(fan.data$TSV,fan.data$fanSpeed) #contingency
chisq.test(table(fan.data$TSV,fan.data$fanSpeed)) #low p-value -> independent
fisher.test(fan.data$TSV,fan.data$fanSpeed)
cramerV(coTable,bias.correct =TRUE)
0.# MAKE MODELS WITH ORDINAL PACKAGE
# ordinal variables (ranked data, distance between values not known)
model0.clm <- clm( TSV ~ fanSpeed, data = fan.data )
summary(model0.clm) #
model0f.clm <- clm( TSV ~ fanSpeed.f, data = fan.data )
summary(model0f.clm)
#Anova(model0.clm,type = 'II')
anova(model0f.clm)
anova(model0.clm)
anova(model0f.clm,model0.clm) #independence not assumed
par(mfrow=c(2,2))
plot(model0.clm)
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
plot(model0.clm)
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
model1f.clm
anova(model1f.clm)
anova(model1f.clm,model0f.clm) # new model is better, both AIC and LogLik wise
x=predict(model0.clm,data=1:20)
plot(predict(model1f.clm)$fit)
plot(fan.data$TSV)
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
### LOAD DATA
fan.data <- read.table(file ='C:/Users/matth/Documents/GitHub/Adv-data-analysis-projects/Ass2/CeilingFan.csv', sep = ";")
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
library(effects)
install.packages("effects")
library(effects)
plot(Effect("Infl"model1f.clm))
plot(Effect("Infl",model1f.clm))
plot(Effect("Infl",model1f.clm))
plot(Effect(model1f.clm))
plot(Effect("TSV".model1f.clm))
plot(Effect("TSV",model1f.clm))
library(MASS)
plot(Effect("TSV",model1f.clm))
plot(Effect("danspeed.f",model1f.clm))
plot(Effect("fanspeed.f",model1f.clm))
plot(Effect("fanspeed.f",model1f.clm))
(Effect("fanspeed.f",model1f.clm))
fan.data$fanSpeed.f <- factor(fan.data$fanSpeed)
fan.data$fanType.f <- factor(fan.data$fanType)
fan.data$TSV <- factor(fan.data$TSV)
(Effect("fanspeed.f",model1f.clm))
(Effect("fan.data$fanspeed.f",model1f.clm))
View(model1f.clm)
(Effect("fan.data$fanSpeed.f",model1f.clm))
(Effect("fanSpeed.f",model1f.clm))
plot(Effect("fanSpeed.f",model1f.clm))
plot(Effect("fanType.f",model1f.clm))
par(mfrow=c(2,1))
plot(Effect("fanSpeed.f",model1f.clm))
plot(Effect("fanType.f",model1f.clm))
par(mfrow=c(2,1))
par(mfrow=c(2,2))
plot(Effect("fanSpeed.f",model1f.clm))
library(usinrR)
library(usingR)
install.packages("usinr")
install.packages("UsingR")
library(usingR)
par(mfrow=c(1,2))
a = plot(Effect("fanSpeed.f",model1f.clm))
b = plot(Effect("fanType.f",model1f.clm))
print(a, position = c(0, 0, 0.5, 1), more = TRUE)
print(b, position = c(0.5, 0, 1, 1))
par(mfrow=c(1,2))
a = plot(Effect("fanSpeed.f",model1f.clm))
b = plot(Effect("fanType.f",model1f.clm))
print(a, position = c(0, 0, 0.5, 1), more = TRUE)
print(b, position = c(0.5, 0, 1, 1))
(gridExtra)
install.packages("gridExtra")
require(gridExtra)
par(mfrow=c(1,2))
plot2 = plot(Effect("fanSpeed.f",model1f.clm))
plot1 = plot(Effect("fanType.f",model1f.clm))
grid.arrange(plot1, plot2, ncol=2)
plot2 = plot(Effect("fanSpeed.f",model1f.clm),multiline=2)
plot1 = plot(Effect("fanType.f",model1f.clm),multiline=2)
grid.arrange(plot1, plot2, ncol=2)
plot2 = plot(Effect("fanSpeed.f",model1f.clm),style="stacked")
plot1 = plot(Effect("fanType.f",model1f.clm),style="stacked")
grid.arrange(plot1, plot2, ncol=2)
plot2 = plot(Effect("fanSpeed.f",model1f.clm),multiline=2)
plot1 = plot(Effect("fanType.f",model1f.clm),multiline=2)
grid.arrange(plot1, plot2, ncol=2)
View(fan.data)
library(ordinal)
library(rcompanion)
library(car)
library(effects)
library(MASS)
library(usingR)
require(gridExtra)
### LOAD DATA
fan.data <- read.table(file ='C:/Users/matth/Documents/GitHub/Adv-data-analysis-projects/Ass2/CeilingFan.csv', sep = ";")
fan.data$fanSpeed.f <- factor(fan.data$fanSpeed)
fan.data$fanType.f <- factor(fan.data$fanType)
# TEST FOR INDEPENDENCE
coTable = table(fan.data$TSV,fan.data$fanSpeed) #contingency
chisq.test(table(fan.data$TSV,fan.data$fanSpeed)) #low p-value -> independent
fisher.test(fan.data$TSV,fan.data$fanSpeed)
cramerV(coTable,bias.correct =TRUE)
0.# MAKE MODELS WITH ORDINAL PACKAGE
# ordinal variables (ranked data, distance between values not known)
model0.clm <- clm( TSV ~ fanSpeed, data = fan.data )
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
fan.data$TSV <- factor(fan.data$TSV)
# TEST FOR INDEPENDENCE
coTable = table(fan.data$TSV,fan.data$fanSpeed) #contingency
chisq.test(table(fan.data$TSV,fan.data$fanSpeed)) #low p-value -> independent
fisher.test(fan.data$TSV,fan.data$fanSpeed)
cramerV(coTable,bias.correct =TRUE)
0.# MAKE MODELS WITH ORDINAL PACKAGE
# ordinal variables (ranked data, distance between values not known)
model0.clm <- clm( TSV ~ fanSpeed, data = fan.data )
summary(model0.clm) #
model0f.clm <- clm( TSV ~ fanSpeed.f, data = fan.data )
summary(model0f.clm)
#Anova(model0.clm,type = 'II')
anova(model0f.clm)
anova(model0.clm)
anova(model0f.clm,model0.clm) #independence not assumed
par(mfrow=c(2,2))
plot(model0.clm)
# CLM FOR TWO DEPENDENT VARIABLES
model1f.clm <- clm( TSV ~ fanSpeed.f + fanType.f, data = fan.data )
model1f.clm
anova(model1f.clm)
anova(model1f.clm,model0f.clm) # new model is better, both AIC and LogLik wise
x=predict(model0.clm,data=1:20)
plot(predict(model1f.clm)$fit)
plot(fan.data$TSV)
#Plots
boxplot(fan.data$TSV ~fan.data$fanSpeed, col=2:6, xlab = "TSV", ylab = "Fan Speed")
plot2 = plot(Effect("fanSpeed.f",model1f.clm))
plot1 = plot(Effect("fanType.f",model1f.clm))
grid.arrange(plot1, plot2, ncol=2)
plot2 = plot(Effect("fanSpeed.f",model1f.clm),multiline=2)
plot1 = plot(Effect("fanType.f",model1f.clm),multiline=2)
grid.arrange(plot1, plot2, ncol=2)
